
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Senju Lore Search Engine</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            background-color: #0a0a12;
            font-family: Arial, sans-serif;
            color: #ffffff;
        }
        header {
            background: linear-gradient(to right, #1c1c2c, #2c2c3c);
            text-align: center;
            padding: 50px 20px 20px 20px;
        }
        header h1 {
            font-size: 42px;
            color: #ffd966;
            margin-bottom: 10px;
        }
        header p {
            font-size: 18px;
            color: #ccc;
        }
        .search-container {
            text-align: center;
            padding: 20px;
        }
        .search-box {
            width: 60%;
            max-width: 500px;
            padding: 12px;
            font-size: 16px;
            border: none;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        .filter-select {
            padding: 10px;
            font-size: 14px;
            border-radius: 6px;
            margin-left: 10px;
        }
        .results {
            width: 80%;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .result {
            background-color: #1a1a26;
            border-left: 4px solid #ffd966;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
        }
        .result h3 {
            margin: 0;
            color: #ffcc66;
        }
        .result p {
            margin: 5px 0 0;
            color: #ccc;
        }
    </style>
</head>
<body>
    <header>
        <h1>Senju Lore Search Engine</h1>
        <p>Search the entire Sir Senju multiverse in one place</p>
    </header>
    <div class="search-container">
        <input type="text" id="searchInput" class="search-box" placeholder="Search characters, factions, energies...">
        <select id="filterSelect" class="filter-select">
            <option value="All">All</option>
            <option value="Character">Characters</option>
            <option value="Faction">Factions</option>
            <option value="Race">Races</option>
            <option value="Energy">Energy Types</option>
            <option value="Ability">Abilities</option>
            <option value="Universe">Universes</option>
        </select>
    </div>
    <div class="results" id="resultsContainer"></div>

    <script src="../js/senju_characters_FULL.js"></script>
    <script src="../js/senju_universes.js"></script>
    <script src="../js/senju_factions.js"></script>
    <script src="../js/senju_energy_types.js"></script>
    <script src="../js/senju_races.js"></script>
    <script>
        let data = [];

        function mergeData() {
            // Ensure variables exist, fallback to empty arrays if undefined
            data = [
                ...(window.senjuCharacters || []).map(c => ({ name: c.name, type: "Character", desc: c.desc })),
                ...(window.senjuFactions || []).map(f => ({ name: f.name, type: "Faction", desc: f.desc })),
                ...(window.senjuRaces || []).map(r => ({ name: r.name, type: "Race", desc: r.desc })),
                ...(window.senjuUniverses || []).map(u => ({ name: u.name, type: "Universe", desc: u.desc })),
                ...(window.senjuEnergyTypes || []).map(e => ({ name: e.name, type: "Energy", desc: e.desc }))
            ];
            renderResults(); // Render initial data
            fetch('../js/full_senju_character_abilities.json')
                .then(res => {
                    if (!res.ok) throw new Error(`Failed to load JSON: ${res.status}`);
                    return res.json();
                })
                .then(abilities => {
                    const formatted = abilities.map(a => ({ name: a.name, type: "Ability", desc: a.desc }));
                    data = [...data, ...formatted];
                    renderResults();
                })
                .catch(err => {
                    console.error('Error loading abilities:', err);
                    renderResults();
                });
        }

        const searchInput = document.getElementById("searchInput");
        const filterSelect = document.getElementById("filterSelect");
        const resultsContainer = document.getElementById("resultsContainer");

        function renderResults() {
            const query = searchInput.value.toLowerCase();
            const filter = filterSelect.value;
            const filtered = data.filter(item => {
                const name = (item.name || '').toLowerCase();
                const desc = (item.desc || '').toLowerCase();
                const matchesQuery = name.includes(query) || desc.includes(query);
                const matchesFilter = filter === "All" || item.type === filter;
                return matchesQuery && matchesFilter;
            });

            resultsContainer.innerHTML = filtered.length > 0
                ? filtered.map(item => `
                    <div class="result">
                        <h3>${item.name} (${item.type})</h3>
                        <p>${item.desc}</p>
                    </div>
                `).join('')
                : '<p>No results found.</p>';
        }

        searchInput.addEventListener("input", renderResults);
        filterSelect.addEventListener("change", renderResults);

        mergeData(); // Initialize after scripts load
    </script>
</body>
</html>
